<div class="row">
    <div class="col-sm-12">
        <app-card [cardTitle]="'GestiÃ³n de Usuarios'" [showHeader]="true">
            <div class="row mb-3">
                <div class="col-md-12 text-end">
                    <button class="btn btn-outline-secondary me-2" [routerLink]="['/users/roles']" *ngIf="canManageRoles">
                        <i class="feather icon-shield"></i> Roles y Permisos
                    </button>
                    <button class="btn btn-primary" [routerLink]="['/users/new']">
                        <i class="feather icon-plus"></i> Nuevo Usuario
                    </button>
                </div>
            </div>

            <div class="table-responsive">
                <table class="table table-hover">
                    <thead>
                        <tr>
                            <th>Nombre</th>
                            <th>Email</th>
                            <th>Rol</th>
                            <th>Estado</th>
                            <th class="text-end">Acciones</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let user of users">
                            <td>
                                <h6 class="m-b-0">{{ user.full_name }}</h6>
                            </td>
                            <td>{{ user.email }}</td>
                            <td>
                                <span class="badge bg-light-primary text-primary">{{ user.role?.name || 'Sin Rol'
                                    }}</span>
                            </td>
                            <td>
                                <span class="badge" [ngClass]="user.is_active ? 'bg-success' : 'bg-danger'">
                                    {{ user.is_active ? 'Activo' : 'Inactivo' }}
                                </span>
                            </td>
                            <td class="text-end">
                                <button [routerLink]="['/users/edit', user.id]"
                                    class="btn btn-icon btn-outline-primary btn-sm me-1">
                                    <i class="feather icon-edit"></i>
                                </button>
                                <button (click)="deleteUser(user.id)" class="btn btn-icon btn-outline-danger btn-sm">
                                    <i class="feather icon-trash-2"></i>
                                </button>
                            </td>
                        </tr>
                        <tr *ngIf="users.length === 0 && !isLoading">
                            <td colspan="5" class="text-center text-muted">No existen usuarios registrados.</td>
                        </tr>
                        <tr *ngIf="isLoading">
                            <td colspan="5" class="text-center">
                                <div class="spinner-border text-primary" role="status"></div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </app-card>
    </div>
</div>
